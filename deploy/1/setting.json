{
    "meta": {
        "hostName": "",
        "admin": "",
        "defaultHosting": "qa.winesoft.co.kr"
    },
    "env": {
        "log": {
            "info": {
                "enable": true,
                "rolling": {
                    "size": 1
                },
                "retention": 5,
                "compression": false
            },
            "deny": {
                "enable": true,
                "rolling": {
                    "size": 1
                },
                "retention": 5,
                "compression": false
            },
            "originError": {
                "enable": true,
                "rolling": {
                    "size": 5
                },
                "retention": 5,
                "warning": false,
                "compression": false
            },
            "repository": {
                "list": [
                    {
                        "name": "m2live",
                        "type": "aws-s3",
                        "rolling": "* *",
                        "path": "/log/{logtype}/domain={domain}/year={timestamp.year}/month={timestamp.month}/day={timestamp.day}/{hostname}_{timestamp.hour}{timestamp.minute}_{logtype}.log.gz",
                        "compression": {
                            "enable": true
                        },
                        "endpoint": {
                            "bucket": "m2livex",
                            "region": "ap-northeast-2",
                            "accessKey": "AKIAUPBJJDGA57S4RU3X",
                            "secretKey": "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"
                        }
                    }
                ]
            }
        }
    },
    "functions": {
        "network": {
            "cache": {
                "ttl": {
                    "resCode": {
                        "onError": {
                            "connectTimeout": 10,
                            "receiveTimeout": 10
                        }
                    }
                }
            },
            "http": {
                "frontEnd": {
                    "headers": {
                        "lastModified": {
                            "rule": "exact"
                        },
                        "ifRange": {
                            "enable": false,
                            "purge": false
                        }
                    },
                    "bypass": {
                        "postMethod": {
                            "enable": true,
                            "enableBackendAffinity": true,
                            "enableSticky": true
                        },
                        "getMethod": {
                            "enable": false,
                            "enableBackendAffinity": true,
                            "enableSticky": true
                        },
                        "putMethod": {
                            "enable": false,
                            "enableBackendAffinity": true,
                            "enableSticky": true
                        },
                        "session": {
                            "connectTimeout": 30,
                            "receiveTimeout": 300
                        }
                    },
                    "session": {
                        "keepAliveSec": 60
                    }
                },
                "backEnd": {
                    "session": {
                        "connectTimeout": 15,
                        "receiveTimeout": 30
                    }
                }
            }
        },
        "operations": {
            "log": {
                "meta": {
                    "dir": "/ston_log"
                },
                "access": {
                    "enable": true,
                    "rolling": {
                        "time": 1440
                    },
                    "retention": 10,
                    "xff": "all",
                    "form": "m2",
                    "loopback": false,
                    "compression": false,
                    "backup": ["m2live"]
                },
                "origin": {
                    "enable": true,
                    "rolling": {
                        "time": 1440
                    },
                    "retention": 10,
                    "loopback": false,
                    "compression": false,
                    "backup": ["m2live"]
                },
                "monitoring": {
                    "enable": true,
                    "rolling": {
                        "size": 10
                    },
                    "retention": 10,
                    "form": "json"
                },
                "dims": {
                    "enable": true,
                    "rolling": {
                        "time": 1440
                    },
                    "retention": 10,
                    "compression": false
                }
            }
        }
    },
    "hosting": [
        {
            "name": "post-test.winesoft.co.kr",
            "enable": true,
            "origin": {
                "protocol": "HTTP",
                "address": [
                    "141.164.49.179:8080"
                ]
            },
            "listen": "*:80",
            "https": [
                {
                    "options": {
                        "enableSsl30": false,
                        "enableTls10": true,
                        "enableTls11": true,
                        "enableTls12": true
                    }
                }
            ],
            "functions": {
                "network": {
                    "http": {
                        "frontEnd": {
                            "bypass": {
                                "postMethod": {
                                    "enable": false,
                                    "enableBackendAffinity": true,
                                    "enableSticky": true
                                },
                                "matchingList": [
                                    {
                                        "pattern": "$URL[*?*bypass=true*]",
                                        "action": "bypass"
                                    }
                                ]
                            },
                            "headers": {
                                "modify": {
                                    "enable": true,
                                    "matchingList": [
                                        {
                                            "pattern": "$URL[*]",
                                            "header": "$RES[x-m2-cache-result:#CACHEHIT]",
                                            "mode": "Set"
                                        }
                                    ]
                                }
                            }
                        }
                    },
                    "cache": {
                        "cachingKey": {
                            "postMethod": {
                                "enable": true,
                                "bodyContentLengthMax": 102400,
                                "bodySensitive": true
                            }
                        }
                    }
                }
            },
            "urlRewrites": [
                {
                    "accessLogUrl": "Replace",
                    "pattern": "(.*)/test-origin/post_test.php\\?(.*)",
                    "replace": "post-test.winesoft.co.kr/test-origin/post_test.php?#2"
                }
            ]
        },
        {
            "name": "qa.winesoft.co.kr",
            "enable": true,
            "origin": {
                "protocol": "HTTP",
                "address": [
                    "gump-origin.ap-south-1.linodeobjects.com"
                ]
            },
            "listen": "*:80",
            "functions": {
                "contents": {
                    "mp4edit": {
                        "meta": {
                            "enable": true,
                            "keyword": "mp4edit"
                        },
                        "trim": {
                            "useAllTracks": true,
                            "maxRatio": 0
                        }
                    },
                    "mp3edit": {
                        "meta": {
                            "enable": true,
                            "keyword": "mp3edit"
                        }
                    },
                    "dims": {
                        "meta": {
                            "enable": true,
                            "keyword": "dims"
                        },
                        "quality": {
                            "max": 99,
                            "format": 99
                        },
                        "composite": [
                            {
                                "name": "composite_nw",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "nw",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_n",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "n",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_ne",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "ne",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_w",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "w",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_c",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "c",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_e",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "e",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_sw",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "sw",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_s",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "s",
                                "geometry": "+0+0",
                                "dissolve": 50
                            },
                            {
                                "name": "composite_se",
                                "path": "/usr/local/m2/rt/winesoft.png",
                                "gravity": "se",
                                "geometry": "+0+0",
                                "dissolve": 50
                            }
                        ]
                    }
                },
                "network": {
                    "cache": {
                        "ttl": {
                            "resCode": {
                                "noCache": {
                                    "sec": 86400,
                                    "max": 0
                                },
                                "res2xx": {
                                    "sec": 86400,
                                    "ratio": 0,
                                    "max": 0
                                },
                                "res3xx": {
                                    "sec": 30
                                }
                            }
                        }
                    },
                    "http": {
                        "frontEnd": {
                            "headers": {
                                "modify": {
                                    "enable": true,
                                    "matchingList": [
                                        {
                                            "pattern": "$URL[*]",
                                            "header": "$RES[x-m2-cache-result:#CACHEHIT]",
                                            "mode": "set"
                                        }
                                    ]
                                }
                            },
                            "accessControl": {
                                "enable": true,
                                "matchingList": [
                                    {
                                        "pattern": "$URL[*?*acl=deny*]",
                                        "action": "deny",
                                        "denialCode": 403
                                    }
                                ]
                            },
                            "bypass": {
                                "matchingList": [
                                    {
                                        "pattern": "$URL[*?*bypass=true*]",
                                        "action": "bypass"
                                    }
                                ]
                            }
                        }
                    },
                    "mp4hls": {
                        "meta": {
                            "enable": true,
                            "keyword": "mp4hls"
                        },
                        "hls": {
                            "duration": 10,
                            "indexName": "index.m3u8",
                            "playlist": {
                                "version": 3,
                                "alternates": false,
                                "alternatesName": "playlist.m3u8",
                                "sequence": 0
                            }
                        }
                    },
                    "mp3hls": {
                        "meta": {
                            "enable": true,
                            "keyword": "mp3hls"
                        },
                        "hls": {
                            "duration": 10,
                            "indexName": "index.m3u8",
                            "segmentType": "ts",
                            "playlist": {
                                "version": 3,
                                "alternates": false,
                                "alternatesName": "playplaylist.m3u8",
                                "sequence": 0
                            }
                        }
                    }
                }
            },
            "urlRewrites": [
                {
                    "accessLogUrl": "Replace",
                    "pattern": "(.*)/(.*)/code/(.*)",
                    "replace": "status-code.winesoft.co.kr/chain/dev-status?status=#3"
                }
            ]
        },
        {
            "name": "status-code.winesoft.co.kr",
            "enable": true,
            "origin": {
                "protocol": "HTTP",
                "address": [
                    "m2.winesoft.co.kr:8585"
                ]
            },
            "listen": "*:80"
        }
    ]
}
